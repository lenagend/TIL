# 이펙티브 자바 - 죠슈아 블로크

### Item1. 생성자 대신 정적 팩터리 메서드를 고려해라

- 메서드를 설명하는 이름을 가질 수 있다

```java
BigInteger(int, int, Random)
BigInteger.probablePrime

//아래 쪽이 값이 소수인 BigInteger을 반환한다는 의미를 잘 설명한다
//한 클래스에 시그니처가 같은 생성자가 여러개 필요할 것 같으면 생성자를 
//정적 팩터리 메서드로 바꾸고 잘 설명하는 이름을 지어주자
```

- 호출될 때마다 인스턴스를 새로 생성하지 않아도 된다(필요없는 리소스의 절약)
- 반환타입의 하위 타입 객체를 반환할 수 있는 능력이 있다
-반환할 객체의 클래스를 자유롭게 선택할 수 있게하는 유연성을 제공한다
-구현 클래스를 공개하지 않고도 객체를 반환할 수 있어 API를 작게 유지할 수 있다
  (예를들어 java.util.Collections)
- 입력 매개변수에 따라 매번 다른 클래스의 객체를 반환할 수 있다
(EnumSet클래스는 원소가 64개 이하면 RegularEnumSet, 65개 이상이면 JumboEnumSet을 반환)
- 정적 팩터리 메서드를 작성하는 시점에는 반환할 객체의 클래스가 존재하지 않아도 된다

### 단점

- 상속을 하려면 public이나 protected생성자가 필요하니 정적 팩터리 메서드만 제공하면 하위 클래스를 만들 수 없다
- 정적 팩터리 메서드는 프로그래머가 찾기 어렵다
메서드 이름을 널리 알려진 규약을 따라 짓는 식으로 문제를 완화해야한다

---

### item2. 생성자에 매개변수가 많다면 빌더를 고려하라

- 생성자에 매개변수가 많거나, 어떤 변수는 필수 어떤 변수는 선택등으로 구분해야하는 상황에서 점층적 생성자 패턴은 클라이언트 코드를 작성하거나 읽기 어렵다
*점층적생성자 패턴이란 매개변수1개인 생성자, 2개인 생성자, 3개, 4개 등…
- 자바빈즈 패턴(매개변수가 없는 생성자와 세터메서드들의 조합)에서는 객체 하나를 만들려면 메서드를 여러개 호출해야하고 객체가 완전히 생성되기 전까지는 일관성이 무너진 상태에 놓인다

우리의 대안은 빌더패턴이다. 빌더는 생성할 클래스 안에 정적 멤버 클래스로 만들어 두는게 보통이다

예시:

```java
public class Person {
    // 필수 매개변수
    private final String firstName;
    private final String lastName;

    // 선택적 매개변수
    private final int age;
    private final String phoneNumber;
    private final String address;

    // 빌더 클래스
    public static class Builder {
        // 필수 매개변수
        private final String firstName;
        private final String lastName;

        // 선택적 매개변수 - 기본값으로 초기화
        private int age = 0;
        private String phoneNumber = "";
        private String address = "";

        // 필수 매개변수만을 받는 생성자
        public Builder(String firstName, String lastName) {
            this.firstName = firstName;
            this.lastName = lastName;
        }

        // 선택적 매개변수 설정 메서드들
        public Builder age(int age) {
            this.age = age;
            return this;
        }

        public Builder phoneNumber(String phoneNumber) {
            this.phoneNumber = phoneNumber;
            return this;
        }

        public Builder address(String address) {
            this.address = address;
            return this;
        }

        // 빌드 메서드: 설정된 값들을 기반으로 Person 객체를 생성
        public Person build() {
            return new Person(this);
        }
    }

    // Person 생성자: 빌더 객체를 통해서만 생성할 수 있음
    private Person(Builder builder) {
        this.firstName = builder.firstName;
        this.lastName = builder.lastName;
        this.age = builder.age;
        this.phoneNumber = builder.phoneNumber;
        this.address = builder.address;
    }

    // Person 클래스의 toString 메서드
    @Override
    public String toString() {
        return "Person [firstName=" + firstName + ", lastName=" + lastName +
               ", age=" + age + ", phoneNumber=" + phoneNumber + ", address=" + address + "]";
    }
}

```

- 빌더패턴은 계층적으로 설계된 클래스와 함께 쓰기에 좋다
- 빌더를 이용하면 가변인수 매개변수를 여러개 사용할 수 있다. 각각을 적절한 메서드로 나눠 선언하면 된다
- 객체마다 부여되는 일련번호와 같은 특정 필드는 빌더가 알아서 채우도록 할 수도 있다

### 단점

- 빌더 패턴에 장점만 있는 것은 아니다. 객체를 만들려면 그에 앞서 빌더부터 만들어야한다. (성능)
- 매개변수가 4개이상은 해야 값어치를 한다
그러나 API는 시간이 지날수록 매개변수가 많아지는 경향이있으므로 처음부터 빌더로 시작하는편이 나을때가 많다